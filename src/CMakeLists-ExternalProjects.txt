include(ExternalProject)

ExternalProject_Add(
  document-graph
  GIT_REPOSITORY "https://github.com/hypha-dao/document-graph.git"
  GIT_TAG "5d6f03e1903bdb727e3a1a8ed2790fee7e251de7"

  SOURCE_DIR "${CMAKE_SOURCE_DIR}/deps/document-graph"
  BINARY_DIR "${CMAKE_BINARY_DIR}/docgraph"
  CMAKE_ARGS -DCMAKE_TOOLCHAIN_FILE=${EOSIO_CDT_ROOT}/lib/cmake/eosio.cdt/EosioWasmToolchain.cmake
  UPDATE_COMMAND ""
  PATCH_COMMAND ""
  TEST_COMMAND ""
  INSTALL_COMMAND ""
  BUILD_ALWAYS 1
  BUILD_BYPRODUCTS  ${CMAKE_BINARY_DIR}/docgraph/docs/docs.wasm
)

set(PARENT_PROJECT_BINARY_DIR ${PROJECT_BINARY_DIR})
ExternalProject_Get_Property(document-graph BINARY_DIR)

set(document_graph_INCLUDE_DIRS "${CMAKE_SOURCE_DIR}/deps/document-graph/include")
set(document_graph_LIBRARIES "${CMAKE_SHARED_LIBRARY_PREFIX}document_graph{CMAKE_SHARED_LIBRARY_SUFFIX}")
include_directories(${document_graph_INCLUDE_DIRS})
